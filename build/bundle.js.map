{"version":3,"file":"bundle.js","mappings":"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","sources":["webpack://server/./src/application/common/utils/access.js","webpack://server/./src/application/common/utils/secret.js","webpack://server/./src/application/config/sockets.js","webpack://server/./src/application/config/swagger.js","webpack://server/./src/application/database/index.js","webpack://server/./src/application/documentation/index.js","webpack://server/./src/application/middlewares/error-handler.js","webpack://server/./src/application/middlewares/index.js","webpack://server/./src/application/middlewares/restricted-access.js","webpack://server/./src/application/middlewares/with-sockets.js","webpack://server/./src/application/repository/generic-model.js","webpack://server/./src/entities/index.js","webpack://server/./src/entities/user/adapters/http/index.js","webpack://server/./src/entities/user/controller/index.js","webpack://server/./src/entities/user/model/index.js","webpack://server/./src/entities/user/model/schema.js","webpack://server/external commonjs \"@babel/runtime/helpers/asyncToGenerator\"","webpack://server/external commonjs \"@babel/runtime/helpers/defineProperty\"","webpack://server/external commonjs \"@babel/runtime/regenerator\"","webpack://server/external commonjs \"cors\"","webpack://server/external commonjs \"express\"","webpack://server/external commonjs \"jsonwebtoken\"","webpack://server/external commonjs \"jwks-rsa\"","webpack://server/external commonjs \"sequelize\"","webpack://server/external commonjs \"socket.io\"","webpack://server/external commonjs \"swagger-jsdoc\"","webpack://server/external commonjs \"swagger-ui-express\"","webpack://server/external node-commonjs \"http\"","webpack://server/webpack/bootstrap","webpack://server/webpack/runtime/compat get default export","webpack://server/webpack/runtime/define property getters","webpack://server/webpack/runtime/hasOwnProperty shorthand","webpack://server/webpack/runtime/make namespace object","webpack://server/./src/index.js"],"sourcesContent":["import jwt from 'jsonwebtoken';\r\nimport { getKey } from './secret';\r\n\r\nexport const verifyToken = token => new Promise(((resolve, reject) => {\r\n    jwt.verify(token, getKey, (err, decoded) => err || !decoded\r\n        ? reject(err)\r\n        : resolve({ ...decoded, id: decoded.sub || decoded.id }));\r\n}));","import jwksClient from 'jwks-rsa';\r\n\r\nconst { JWKS_URI } = process.env;\r\n\r\nconst client = jwksClient({ jwksUri: String(JWKS_URI) });\r\n\r\nexport const getKey = (header, callback) => {\r\n    client.getSigningKey(header.kid, (err, key) => {\r\n        if (err) return callback(err);\r\n        const signingKey = key.getPublicKey();\r\n        callback(err, signingKey);\r\n    });\r\n};\r\n","\r\nexport const config = {\r\n    cors: {\r\n        origin: \"*\",\r\n        methods: [\"GET\", \"POST\"],\r\n        credentials: true\r\n    },\r\n    allowEIO3: true\r\n};","export const swaggerConfig = {\r\n  definition: {\r\n    openapi: '3.0.0',\r\n    info: {\r\n      title: 'Test API',\r\n      version: '1.0.0',\r\n    },\r\n    components: {\r\n      securitySchemes: {\r\n        ApiKeyAuth: {\r\n          type: 'apiKey',\r\n          name: 'x-access-token',\r\n          in: 'header',\r\n        },\r\n      },\r\n    },\r\n    security: [\r\n      { ApiKeyAuth: [] },\r\n    ],\r\n    securityDefinitions: {\r\n      basicAuth: {\r\n        type: 'basic'\r\n      },\r\n    },\r\n  },\r\n  // Path to the API docs\r\n  apis: ['./src/entities/**/*.js', './src/entities/**/*.yml'],\r\n};\r\n\r\n","import { Sequelize, DataTypes } from 'sequelize';\r\n\r\nconst database = process.env.DB_NAME;\r\nconst user = process.env.DB_USER;\r\nconst password = process.env.DB_PASSWORD;\r\nconst host = process.env.DB_HOST;\r\nconst forceCleanDatabase = process.env.DB_FORCE_CLEAN === 'true';\r\nconst isProduction = process.env.NODE_ENV === 'production';\r\n\r\nexport const db = new Sequelize(database, user, password, {\r\n    host,\r\n    dialect: 'mysql',\r\n    logging: !isProduction && console.log,\r\n});\r\n\r\nexport { DataTypes };\r\n\r\nexport const setAssociations = (db) => {\r\n    Object.keys(db.models).forEach((modelName) => {\r\n        if ('associate' in db.models[modelName]) {\r\n            db.models[modelName].associate(db.models);\r\n        }\r\n    });\r\n};\r\n\r\nexport default async (onConnect) => {\r\n    try {\r\n        await setAssociations(db);\r\n        await db.authenticate();\r\n        await db.sync({ force: forceCleanDatabase });\r\n        onConnect();\r\n        console.log('Database connection OK!');\r\n    } catch (error) {\r\n        console.log('Unable to connect to the database:');\r\n    }\r\n}","import swaggerJSDoc from \"swagger-jsdoc\";\r\nimport swaggerUi from \"swagger-ui-express\";\r\nimport { swaggerConfig } from \"../config/swagger\";\r\n\r\nconst Documentation = (app) => {\r\n  // JSON of specs\r\n  const swaggerSpec = swaggerJSDoc(swaggerConfig);\r\n\r\n  // Api entrypoint\r\n  app.use(\"/docs\", swaggerUi.serve, swaggerUi.setup(swaggerSpec));\r\n};\r\n\r\nexport default Documentation;\r\n","/*Tenemos una función que recibe como parámetro la función de cada controlador,\r\nla ejecuta (resolve)\r\ny si  hay algún error, lo mostrará por consola y lanzará un 500\r\n*/\r\n\r\nexport const asyncHandler = controller => (req, res, next) => Promise\r\n  .resolve(controller(req, res, next))\r\n  .catch((err) => {\r\n    console.error('Request error:' + err.toString());\r\n    if (err) return res.sendStatus(500).send();\r\n});\r\n \r\nexport const socketHandler = controller => msg => Promise\r\n  .resolve(controller(msg))\r\n  .catch((err) => {\r\n    console.error('Socket error:' + err);\r\n});","import express from 'express';\r\nimport cors from 'cors';\r\nimport withSockets from './with-sockets';\r\n\r\nconst Middlewares = (app, io) => {\r\n    app.use(express.urlencoded({extended: true}));\r\n    app.use(express.json());\r\n    app.use(withSockets(io));\r\n    app.use(cors()) // Use this after the variable declaration\r\n};\r\n\r\nexport default Middlewares;","import { verifyToken } from '@Application/common/utils/access';\r\nexport const getHeader = (req, header) => req.headers[header];\r\n\r\nexport default (req, res, next) => {\r\n  const token = getHeader(req, 'authorization');\r\n\r\n  if (!token) {\r\n    return res.status(400).send('No token provided.');\r\n  }\r\n  return verifyToken(token, (err, { id } = {}) => {\r\n    if (err) {\r\n      return res.status(401).send('Failed to authenticate token.');\r\n    }\r\n\r\n    if (!id) {\r\n      return res.status(403).send('Wrong credentials');\r\n    }\r\n    req.userId = id;\r\n    return next();\r\n  });\r\n}","const withSockets = io => (req, res, next) => {\r\n    req.io = io;\r\n    return next();\r\n};\r\n\r\nexport default withSockets;\r\n","\r\nconst GenericModel = Model => ({\r\n    create(data) {\r\n        return Model.create(data);\r\n    },\r\n    get(conditions) {\r\n        return Model.findAll(conditions ? {where:conditions} : {});\r\n    },\r\n    getById(id) {\r\n        return Model.findOne({ where: { id } });\r\n    },\r\n    updateById(id, data) {\r\n        return Model.update(data, { where: { id } });\r\n    },\r\n    deleteById(id) {\r\n        return Model.destroy({ where: { id } });\r\n    },\r\n    findOrCreate(condition, newObj){\r\n        return Model.findOrCreate({where:condition, defaults: newObj});\r\n    }\r\n});\r\n\r\nexport default GenericModel;\r\n","import userRoutes from './user/adapters/http';\r\n// import userSockets from './user/adapters/socket';\r\n// import authRoutes from './auth/adapters/http';\r\n\r\nexport const Routes = (app) => {\r\n  userRoutes(app, '/user');\r\n  //  authRoutes(app);\r\n\r\n}\r\n\r\nexport const Sockets = (io, socket) => {\r\n  // userSockets(io, socket);\r\n}","import express from 'express';\r\nimport Controller from '../../controller';\r\nimport { asyncHandler } from \"@Middlwares/error-handler\";\r\n// Para operaciones con acceso restringido, introduciremos un segundo parámetro que será la variable restrictedAccess\r\nimport restrictedAccess from \"@Middlwares/restricted-access\";\r\n\r\nconst router = express.Router();\r\n\r\nrouter.get('/', asyncHandler(async (req, res) => {\r\n    // await Controller.create({ email: 'borrame@borrame.com' });\r\n    res.send('Llegamos a user');\r\n}));\r\n\r\nexport default (app, entityUrl) => app.use(entityUrl, router);\r\n","import Model from \"../model\";\r\n\r\nconst Controller = {\r\n  get(conditions) {\r\n    return Model.get(conditions);\r\n  },\r\n  getById(id) {\r\n    return Model.getById(id);\r\n  },\r\n  create(data) {\r\n    return Model.create(data);\r\n  },\r\n  updateById(id, data) {\r\n    return Model.updateById(id, data);\r\n  },\r\n  deleteById(id) {\r\n    return Model.deleteById(id);\r\n  }\r\n}\r\n\r\nexport default Controller;","import GenericModel from '@Application/repository/generic-model';\r\nimport Schema from './schema';\r\n\r\nconst Model = {\r\n    ...GenericModel(Schema),\r\n    getByEmail: email => Schema.findOne({ where: { email } })\r\n};\r\n\r\nexport default Model;\r\n\r\n","import { db, DataTypes } from '@Application/database';\r\n\r\nexport default db.define('user', {\r\n\temail: DataTypes.STRING,\r\n\tauth0Id: DataTypes.STRING,\r\n});\r\n\r\n","module.exports = require(\"@babel/runtime/helpers/asyncToGenerator\");","module.exports = require(\"@babel/runtime/helpers/defineProperty\");","module.exports = require(\"@babel/runtime/regenerator\");","module.exports = require(\"cors\");","module.exports = require(\"express\");","module.exports = require(\"jsonwebtoken\");","module.exports = require(\"jwks-rsa\");","module.exports = require(\"sequelize\");","module.exports = require(\"socket.io\");","module.exports = require(\"swagger-jsdoc\");","module.exports = require(\"swagger-ui-express\");","module.exports = require(\"http\");","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import express from 'express';\r\nimport http from 'http';\r\nimport { Server } from 'socket.io';\r\nimport { config } from '@Application/config/sockets';\r\nimport Middlewares from './application/middlewares';\r\nimport { Routes, Sockets } from './entities';\r\nimport Documentation from './application/documentation';\r\nimport ConnectDatabase from './application/database';\r\n\r\nconst app = express();\r\n/*\r\nHeroku utiliza la variable de entorno process.env.port para asignar el puerto donde se va ejecutar el servidor,\r\npor eso la hemos definido en esta plantilla\r\n*/\r\nconst port = process.env.PORT;\r\nconst server = http.createServer(app);\r\nconst io = new Server(server, config);\r\n\r\n\r\n\r\n\r\nConnectDatabase(() => {\r\n    Documentation(app);\r\n    Middlewares(app, io);\r\n    Routes(app);\r\n\r\n    io.on('connection', (socket) => {\r\n        console.log(88)\r\n        Sockets(io, socket);\r\n    });\r\n    server.listen(port, () => console.log(`Server listening to http://localhost:${port}`));\r\n});\r\n"],"names":["jwt","getKey","verifyToken","token","Promise","resolve","reject","verify","err","decoded","_objectSpread","id","sub","jwksClient","JWKS_URI","process","env","client","jwksUri","String","header","callback","getSigningKey","kid","key","signingKey","getPublicKey","config","cors","origin","methods","credentials","allowEIO3","swaggerConfig","definition","openapi","info","title","version","components","securitySchemes","ApiKeyAuth","type","name","security","securityDefinitions","basicAuth","apis","Sequelize","DataTypes","database","DB_NAME","user","DB_USER","password","DB_PASSWORD","host","DB_HOST","forceCleanDatabase","DB_FORCE_CLEAN","isProduction","NODE_ENV","db","dialect","logging","console","log","setAssociations","Object","keys","models","forEach","modelName","associate","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","onConnect","wrap","_callee$","_context","prev","next","authenticate","sync","force","t0","stop","_x","apply","arguments","swaggerJSDoc","swaggerUi","Documentation","app","swaggerSpec","use","serve","setup","asyncHandler","controller","req","res","error","toString","sendStatus","send","socketHandler","msg","express","withSockets","Middlewares","io","urlencoded","extended","json","getHeader","headers","status","length","undefined","userId","GenericModel","Model","create","data","get","conditions","findAll","where","getById","findOne","updateById","update","deleteById","destroy","findOrCreate","condition","newObj","defaults","userRoutes","Routes","Sockets","socket","Controller","restrictedAccess","router","Router","_x2","entityUrl","Schema","getByEmail","email","define","STRING","auth0Id","http","Server","ConnectDatabase","port","PORT","server","createServer","on","listen","concat"],"sourceRoot":""}