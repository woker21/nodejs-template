{"version":3,"file":"bundle.js","mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AAEO,IAAME,WAAW,GAAG,SAAdA,WAAc,CAAAC,KAAK;AAAA,SAAI,IAAIC,OAAJ,CAAa,UAACC,OAAD,EAAUC,MAAV,EAAqB;AAClEN,IAAAA,0DAAA,CAAWG,KAAX,EAAkBF,2CAAlB,EAA0B,UAACO,GAAD,EAAMC,OAAN;AAAA,aAAkBD,GAAG,IAAI,CAACC,OAAR,GACtCH,MAAM,CAACE,GAAD,CADgC,GAEtCH,OAAO,iCAAMI,OAAN;AAAeC,QAAAA,EAAE,EAAED,OAAO,CAACE,GAAR,IAAeF,OAAO,CAACC;AAA1C,SAFa;AAAA,KAA1B;AAGH,GAJmC,CAAJ;AAAA,CAAzB;;;;;;;;;;;;;;;;ACHP;AAEA,IAAQG,QAAR,GAAqBC,OAAO,CAACC,GAA7B,CAAQF,QAAR;AAEA,IAAMG,MAAM,GAAGJ,+CAAU,CAAC;AAAEK,EAAAA,OAAO,EAAEC,MAAM,CAACL,QAAD;AAAjB,CAAD,CAAzB;AAEO,IAAMZ,MAAM,GAAG,SAATA,MAAS,CAACkB,MAAD,EAASC,QAAT,EAAsB;AACxCJ,EAAAA,MAAM,CAACK,aAAP,CAAqBF,MAAM,CAACG,GAA5B,EAAiC,UAACd,GAAD,EAAMe,GAAN,EAAc;AAC3C,QAAIf,GAAJ,EAAS,OAAOY,QAAQ,CAACZ,GAAD,CAAf;AACT,QAAMgB,UAAU,GAAGD,GAAG,CAACE,YAAJ,EAAnB;AACAL,IAAAA,QAAQ,CAACZ,GAAD,EAAMgB,UAAN,CAAR;AACH,GAJD;AAKH,CANM;;;;;;;;;;;;;;ACLA,IAAME,MAAM,GAAG;AAClBC,EAAAA,IAAI,EAAE;AACFC,IAAAA,MAAM,EAAE,uBADN;AAEFC,IAAAA,OAAO,EAAE,CAAC,KAAD,EAAQ,MAAR,CAFP;AAGFC,IAAAA,WAAW,EAAE;AAHX,GADY;AAMlBC,EAAAA,SAAS,EAAE;AANO,CAAf;;;;;;;;;;;;;;ACDA,IAAMC,aAAa,GAAG;AAC3BC,EAAAA,UAAU,EAAE;AACVC,IAAAA,OAAO,EAAE,OADC;AAEVC,IAAAA,IAAI,EAAE;AACJC,MAAAA,KAAK,EAAE,UADH;AAEJC,MAAAA,OAAO,EAAE;AAFL,KAFI;AAMVC,IAAAA,UAAU,EAAE;AACVC,MAAAA,eAAe,EAAE;AACfC,QAAAA,UAAU,EAAE;AACVC,UAAAA,IAAI,EAAE,QADI;AAEVC,UAAAA,IAAI,EAAE,gBAFI;AAGV,gBAAI;AAHM;AADG;AADP,KANF;AAeVC,IAAAA,QAAQ,EAAE,CACR;AAAEH,MAAAA,UAAU,EAAE;AAAd,KADQ,CAfA;AAkBVI,IAAAA,mBAAmB,EAAE;AACnBC,MAAAA,SAAS,EAAE;AACTJ,QAAAA,IAAI,EAAE;AADG;AADQ;AAlBX,GADe;AAyB3B;AACAK,EAAAA,IAAI,EAAE,CAAC,wBAAD,EAA2B,yBAA3B;AA1BqB,CAAtB;;;;;;;;;;;;;;;;;;;;;;;;;ACAP;AAEA,IAAMG,QAAQ,GAAGnC,UAAjB;AACA,IAAMqC,IAAI,GAAGrC,MAAb;AACA,IAAMuC,QAAQ,GAAGvC,EAAjB;AACA,IAAMyC,IAAI,GAAGzC,WAAb;AACA,IAAM2C,kBAAkB,GAAG3C,MAAA,KAA+B,MAA1D;AAEO,IAAM6C,EAAE,GAAG,IAAIZ,gDAAJ,CAAcE,QAAd,EAAwBE,IAAxB,EAA8BE,QAA9B,EAAwC;AACtDE,EAAAA,IAAI,EAAJA,IADsD;AAEtDK,EAAAA,OAAO,EAAE,OAF6C;AAGtDC,EAAAA,OAAO,EAAE;AAH6C,CAAxC,CAAX;AAMP;AAEO,IAAMC,eAAe,GAAG,SAAlBA,eAAkB,CAACH,EAAD,EAAQ;AACnCI,EAAAA,MAAM,CAACC,IAAP,CAAYL,EAAE,CAACM,MAAf,EAAuBC,OAAvB,CAA+B,UAACC,SAAD,EAAe;AAC1C,QAAI,eAAeR,EAAE,CAACM,MAAH,CAAUE,SAAV,CAAnB,EAAyC;AACrCR,MAAAA,EAAE,CAACM,MAAH,CAAUE,SAAV,EAAqBC,SAArB,CAA+BT,EAAE,CAACM,MAAlC;AACH;AACJ,GAJD;AAKH,CANM;AAQP;AAAA,iLAAe,iBAAOI,SAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAEDP,eAAe,CAACH,EAAD,CAFd;;AAAA;AAAA;AAAA,mBAGDA,EAAE,CAACW,YAAH,EAHC;;AAAA;AAIPX,YAAAA,EAAE,CAACY,IAAH,CAAQ;AAAEC,cAAAA,KAAK,EAAEf;AAAT,aAAR;AACAY,YAAAA,SAAS;AACTI,YAAAA,OAAO,CAACC,GAAR,CAAY,yBAAZ;AANO;AAAA;;AAAA;AAAA;AAAA;AAQPD,YAAAA,OAAO,CAACC,GAAR,CAAY,oCAAZ;;AARO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAf;;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;ACxBA;AACA;AACA;;AAEA,IAAMG,aAAa,GAAG,SAAhBA,aAAgB,CAACC,GAAD,EAAS;AAC7B;AACA,MAAMC,WAAW,GAAGJ,oDAAY,CAAC3C,0DAAD,CAAhC,CAF6B,CAI7B;;AACA8C,EAAAA,GAAG,CAACE,GAAJ,CAAQ,OAAR,EAAiBJ,iEAAjB,EAAkCA,+DAAA,CAAgBG,WAAhB,CAAlC;AACD,CAND;;AAQA,iEAAeF,aAAf;;;;;;;;;;;;;;;ACZA;AACA;AACA;AACA;AAEO,IAAMM,YAAY,GAAG,SAAfA,YAAe,CAAAC,UAAU;AAAA,SAAI,UAACC,GAAD,EAAMC,GAAN,EAAWC,IAAX;AAAA,WAAoBnF,OAAO,CAClEC,OAD2D,CACnD+E,UAAU,CAACC,GAAD,EAAMC,GAAN,EAAWC,IAAX,CADyC,WAErD,UAAC/E,GAAD,EAAS;AACdiE,MAAAA,OAAO,CAACe,KAAR,CAAc,mBAAmBhF,GAAG,CAACiF,QAAJ,EAAjC;AACA,UAAIjF,GAAJ,EAAS,OAAO8E,GAAG,CAACI,UAAJ,CAAe,GAAf,EAAoBC,IAApB,EAAP;AACZ,KAL6D,CAApB;AAAA,GAAJ;AAAA,CAA/B;AAOA,IAAMC,aAAa,GAAG,SAAhBA,aAAgB,CAAAR,UAAU;AAAA,SAAI,UAAAS,GAAG;AAAA,WAAIzF,OAAO,CACtDC,OAD+C,CACvC+E,UAAU,CAACS,GAAD,CAD6B,WAEzC,UAACrF,GAAD,EAAS;AACdiE,MAAAA,OAAO,CAACe,KAAR,CAAc,kBAAkBhF,GAAhC;AACH,KAJiD,CAAJ;AAAA,GAAP;AAAA,CAAhC;;;;;;;;;;;;;;;;;;;ACZP;AACA;AACA;;AAEA,IAAMwF,WAAW,GAAG,SAAdA,WAAc,CAAClB,GAAD,EAAMmB,EAAN,EAAa;AAC7BnB,EAAAA,GAAG,CAACE,GAAJ,CAAQc,yDAAA,CAAmB;AAACK,IAAAA,QAAQ,EAAE;AAAX,GAAnB,CAAR;AACArB,EAAAA,GAAG,CAACE,GAAJ,CAAQc,mDAAA,EAAR;AACAhB,EAAAA,GAAG,CAACE,GAAJ,CAAQe,yDAAW,CAACE,EAAD,CAAnB;AACAnB,EAAAA,GAAG,CAACE,GAAJ,CAAQrD,2CAAI,EAAZ,EAJ6B,CAIb;AACnB,CALD;;AAOA,iEAAeqE,WAAf;;;;;;;;;;;;;;;;ACXA;AACO,IAAMK,SAAS,GAAG,SAAZA,SAAY,CAAChB,GAAD,EAAMlE,MAAN;AAAA,SAAiBkE,GAAG,CAACiB,OAAJ,CAAYnF,MAAZ,CAAjB;AAAA,CAAlB;AAEP,iEAAe,UAACkE,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AACjC,MAAMpF,KAAK,GAAGkG,SAAS,CAAChB,GAAD,EAAM,eAAN,CAAvB;;AAEA,MAAI,CAAClF,KAAL,EAAY;AACV,WAAOmF,GAAG,CAACiB,MAAJ,CAAW,GAAX,EAAgBZ,IAAhB,CAAqB,oBAArB,CAAP;AACD;;AACD,SAAOzF,6EAAW,CAACC,KAAD,EAAQ,UAACK,GAAD,EAAsB;AAAA,mFAAP,EAAO;AAAA,QAAdE,EAAc,QAAdA,EAAc;;AAC9C,QAAIF,GAAJ,EAAS;AACP,aAAO8E,GAAG,CAACiB,MAAJ,CAAW,GAAX,EAAgBZ,IAAhB,CAAqB,+BAArB,CAAP;AACD;;AAED,QAAI,CAACjF,EAAL,EAAS;AACP,aAAO4E,GAAG,CAACiB,MAAJ,CAAW,GAAX,EAAgBZ,IAAhB,CAAqB,mBAArB,CAAP;AACD;;AACDN,IAAAA,GAAG,CAACmB,MAAJ,GAAa9F,EAAb;AACA,WAAO6E,IAAI,EAAX;AACD,GAViB,CAAlB;AAWD,CAjBD;;;;;;;;;;;;;;ACHA,IAAMQ,WAAW,GAAG,SAAdA,WAAc,CAAAE,EAAE;AAAA,SAAI,UAACZ,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AAC1CF,IAAAA,GAAG,CAACY,EAAJ,GAASA,EAAT;AACA,WAAOV,IAAI,EAAX;AACH,GAHqB;AAAA,CAAtB;;AAKA,iEAAeQ,WAAf;;;;;;;;;;;;;;ACJA,IAAMU,YAAY,GAAG,SAAfA,YAAe,CAAAC,KAAK;AAAA,SAAK;AAC3BC,IAAAA,MAD2B,kBACpBC,IADoB,EACd;AACT,aAAOF,KAAK,CAACC,MAAN,CAAaC,IAAb,CAAP;AACH,KAH0B;AAI3BC,IAAAA,GAJ2B,eAIvBC,UAJuB,EAIX;AACZ,aAAOJ,KAAK,CAACK,OAAN,CAAcD,UAAU,GAAG;AAACE,QAAAA,KAAK,EAACF;AAAP,OAAH,GAAwB,EAAhD,CAAP;AACH,KAN0B;AAO3BG,IAAAA,OAP2B,mBAOnBvG,EAPmB,EAOf;AACR,aAAOgG,KAAK,CAACQ,OAAN,CAAc;AAAEF,QAAAA,KAAK,EAAE;AAAEtG,UAAAA,EAAE,EAAFA;AAAF;AAAT,OAAd,CAAP;AACH,KAT0B;AAU3ByG,IAAAA,UAV2B,sBAUhBzG,EAVgB,EAUZkG,IAVY,EAUN;AACjB,aAAOF,KAAK,CAACU,MAAN,CAAaR,IAAb,EAAmB;AAAEI,QAAAA,KAAK,EAAE;AAAEtG,UAAAA,EAAE,EAAFA;AAAF;AAAT,OAAnB,CAAP;AACH,KAZ0B;AAa3B2G,IAAAA,UAb2B,sBAahB3G,EAbgB,EAaZ;AACX,aAAOgG,KAAK,CAACY,OAAN,CAAc;AAAEN,QAAAA,KAAK,EAAE;AAAEtG,UAAAA,EAAE,EAAFA;AAAF;AAAT,OAAd,CAAP;AACH,KAf0B;AAgB3B6G,IAAAA,YAhB2B,wBAgBdC,SAhBc,EAgBHC,MAhBG,EAgBI;AAC3B,aAAOf,KAAK,CAACa,YAAN,CAAmB;AAACP,QAAAA,KAAK,EAACQ,SAAP;AAAkBE,QAAAA,QAAQ,EAAED;AAA5B,OAAnB,CAAP;AACH;AAlB0B,GAAL;AAAA,CAA1B;;AAqBA,iEAAehB,YAAf;;;;;;;;;;;;;;;;CCrBA;AACA;;AAEO,IAAMmB,MAAM,GAAG,SAATA,MAAS,CAAC9C,GAAD,EAAS;AAC7B6C,EAAAA,+DAAU,CAAC7C,GAAD,CAAV,CAD6B,CAE7B;AACD,CAHM;AAKA,IAAM+C,OAAO,GAAG,SAAVA,OAAU,CAAC5B,EAAD,EAAK6B,MAAL,EAAgB,CACrC;AACD,CAFM;;;;;;;;;;;;;;;;;;;;;;;;;ACTP;AACA;CAEA;;AACA;AAEA,IAAMG,MAAM,GAAGnC,qDAAA,EAAf;AAEAmC,MAAM,CAACpB,GAAP,CAAW,GAAX,EAAgB1B,uEAAY;AAAA,iLAAC,iBAAOE,GAAP,EAAYC,GAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBACnByC,0DAAA,CAAkB;AAAEI,cAAAA,KAAK,EAAE;AAAT,aAAlB,CADmB;;AAAA;AAEzB7C,YAAAA,GAAG,CAACK,IAAJ,CAAS,iBAAT;;AAFyB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAD;;AAAA;AAAA;AAAA;AAAA,IAA5B;AAKA,iEAAe,UAAAb,GAAG;AAAA,SAAIA,GAAG,CAACE,GAAJ,CAAQ,OAAR,EAAiBiD,MAAjB,CAAJ;AAAA,CAAlB;;;;;;;;;;;;;;;ACbA;AAEA,IAAMF,UAAU,GAAG;AACjBlB,EAAAA,GADiB,eACbC,UADa,EACD;AACd,WAAOJ,kDAAA,CAAUI,UAAV,CAAP;AACD,GAHgB;AAIjBG,EAAAA,OAJiB,mBAITvG,EAJS,EAIL;AACV,WAAOgG,sDAAA,CAAchG,EAAd,CAAP;AACD,GANgB;AAOjBiG,EAAAA,MAPiB,kBAOVC,IAPU,EAOJ;AACX,WAAOF,qDAAA,CAAaE,IAAb,CAAP;AACD,GATgB;AAUjBO,EAAAA,UAViB,sBAUNzG,EAVM,EAUFkG,IAVE,EAUI;AACnB,WAAOF,yDAAA,CAAiBhG,EAAjB,EAAqBkG,IAArB,CAAP;AACD,GAZgB;AAajBS,EAAAA,UAbiB,sBAaN3G,EAbM,EAaF;AACb,WAAOgG,yDAAA,CAAiBhG,EAAjB,CAAP;AACD;AAfgB,CAAnB;AAkBA,iEAAeqH,UAAf;;;;;;;;;;;;;;;;;;;;;;;;ACpBA;AACA;;AAEA,IAAMrB,KAAK,mCACJD,iFAAY,CAAC2B,+CAAD,CADR;AAEPC,EAAAA,UAAU,EAAE,oBAAAF,KAAK;AAAA,WAAIC,uDAAA,CAAe;AAAEpB,MAAAA,KAAK,EAAE;AAAEmB,QAAAA,KAAK,EAALA;AAAF;AAAT,KAAf,CAAJ;AAAA;AAFV,EAAX;;AAKA,iEAAezB,KAAf;;;;;;;;;;;;;;;ACRA;AAEA,iEAAe/C,4DAAA,CAAU,MAAV,EAAkB;AAChCwE,EAAAA,KAAK,EAAEnF,mEADyB;AAEhCwF,EAAAA,OAAO,EAAExF,mEAAgBuF;AAFO,CAAlB,CAAf;;;;;;;;;;ACFA;;;;;;;;;;ACAA;;;;;;;;;;ACAA;;;;;;;;;;ACAA;;;;;;;;;;ACAA;;;;;;;;;;ACAA;;;;;;;;;;ACAA;;;;;;;;;;ACAA;;;;;;;;;;ACAA;;;;;;;;;;ACAA;;;;;;;;;;ACAA;;;;;;;;;;ACAA;;;;;;UCAA;UACA;;UAEA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;;UAEA;UACA;;UAEA;UACA;UACA;;;;;WCtBA;WACA;WACA;WACA;WACA;WACA,iCAAiC,WAAW;WAC5C;WACA;;;;;WCPA;WACA;WACA;WACA;WACA,yCAAyC,wCAAwC;WACjF;WACA;WACA;;;;;WCPA;;;;;WCAA;WACA;WACA;WACA,uDAAuD,iBAAiB;WACxE;WACA,gDAAgD,aAAa;WAC7D;;;;;;;;;;;;;;;;;;;;;;ACNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA,IAAMzD,GAAG,GAAGgB,8CAAO,EAAnB;AACA;AACA;AACA;AACA;;AACA,IAAM8C,IAAI,GAAG9H,MAAb;AACA,IAAMgI,MAAM,GAAGL,wDAAA,CAAkB3D,GAAlB,CAAf;AACA,IAAMmB,EAAE,GAAGyC,gDAAQ,CAACI,MAAD,EAASpH,+DAAT,CAAnB;AAEAmD,sEAAa,CAACC,GAAD,CAAb;AACAkB,oEAAW,CAAClB,GAAD,EAAMmB,EAAN,CAAX;AACA2B,iDAAM,CAAC9C,GAAD,CAAN;AAGA6D,iEAAe,CAAC,YAAM;AAClBG,EAAAA,MAAM,CAACE,MAAP,CAAcJ,IAAd,EAAoB;AAAA,WAAMnE,OAAO,CAACC,GAAR,gDAAoDkE,IAApD,EAAN;AAAA,GAApB;AACH,CAFc,CAAf;AAIA3C,EAAE,CAACgD,EAAH,CAAM,YAAN,EAAoB,UAACnB,MAAD,EAAY;AAC5BD,EAAAA,kDAAO,CAAC5B,EAAD,EAAK6B,MAAL,CAAP;AACH,CAFD,E","sources":["webpack://server/./src/application/common/utils/access.js","webpack://server/./src/application/common/utils/secret.js","webpack://server/./src/application/config/sockets.js","webpack://server/./src/application/config/swagger.js","webpack://server/./src/application/database/index.js","webpack://server/./src/application/documentation/index.js","webpack://server/./src/application/middlewares/error-handler.js","webpack://server/./src/application/middlewares/index.js","webpack://server/./src/application/middlewares/restricted-access.js","webpack://server/./src/application/middlewares/with-sockets.js","webpack://server/./src/application/repository/generic-model.js","webpack://server/./src/entities/index.js","webpack://server/./src/entities/user/adapters/http/index.js","webpack://server/./src/entities/user/controller/index.js","webpack://server/./src/entities/user/model/index.js","webpack://server/./src/entities/user/model/schema.js","webpack://server/external commonjs \"@babel/runtime/helpers/asyncToGenerator\"","webpack://server/external commonjs \"@babel/runtime/helpers/defineProperty\"","webpack://server/external commonjs \"@babel/runtime/regenerator\"","webpack://server/external commonjs \"cors\"","webpack://server/external commonjs \"express\"","webpack://server/external commonjs \"jsonwebtoken\"","webpack://server/external commonjs \"jwks-rsa\"","webpack://server/external commonjs \"sequelize\"","webpack://server/external commonjs \"socket.io\"","webpack://server/external commonjs \"swagger-jsdoc\"","webpack://server/external commonjs \"swagger-ui-express\"","webpack://server/external node-commonjs \"http\"","webpack://server/webpack/bootstrap","webpack://server/webpack/runtime/compat get default export","webpack://server/webpack/runtime/define property getters","webpack://server/webpack/runtime/hasOwnProperty shorthand","webpack://server/webpack/runtime/make namespace object","webpack://server/./src/index.js"],"sourcesContent":["import jwt from 'jsonwebtoken';\r\nimport { getKey } from './secret';\r\n\r\nexport const verifyToken = token => new Promise(((resolve, reject) => {\r\n    jwt.verify(token, getKey, (err, decoded) => err || !decoded\r\n        ? reject(err)\r\n        : resolve({ ...decoded, id: decoded.sub || decoded.id }));\r\n}));","import jwksClient from 'jwks-rsa';\r\n\r\nconst { JWKS_URI } = process.env;\r\n\r\nconst client = jwksClient({ jwksUri: String(JWKS_URI) });\r\n\r\nexport const getKey = (header, callback) => {\r\n    client.getSigningKey(header.kid, (err, key) => {\r\n        if (err) return callback(err);\r\n        const signingKey = key.getPublicKey();\r\n        callback(err, signingKey);\r\n    });\r\n};\r\n","\r\nexport const config = {\r\n    cors: {\r\n        origin: \"http://localhost:8080\",\r\n        methods: [\"GET\", \"POST\"],\r\n        credentials: true\r\n    },\r\n    allowEIO3: true\r\n};","export const swaggerConfig = {\r\n  definition: {\r\n    openapi: '3.0.0',\r\n    info: {\r\n      title: 'Test API',\r\n      version: '1.0.0',\r\n    },\r\n    components: {\r\n      securitySchemes: {\r\n        ApiKeyAuth: {\r\n          type: 'apiKey',\r\n          name: 'x-access-token',\r\n          in: 'header',\r\n        },\r\n      },\r\n    },\r\n    security: [\r\n      { ApiKeyAuth: [] },\r\n    ],\r\n    securityDefinitions: {\r\n      basicAuth: {\r\n        type: 'basic'\r\n      },\r\n    },\r\n  },\r\n  // Path to the API docs\r\n  apis: ['./src/entities/**/*.js', './src/entities/**/*.yml'],\r\n};\r\n\r\n","import { Sequelize, DataTypes } from 'sequelize';\r\n\r\nconst database = process.env.DB_NAME;\r\nconst user = process.env.DB_USER;\r\nconst password = process.env.DB_PASSWORD;\r\nconst host = process.env.DB_HOST;\r\nconst forceCleanDatabase = process.env.DB_FORCE_CLEAN === 'true';\r\n\r\nexport const db = new Sequelize(database, user, password, {\r\n    host,\r\n    dialect: 'mysql',\r\n    logging: false,\r\n});\r\n\r\nexport { DataTypes };\r\n\r\nexport const setAssociations = (db) => {\r\n    Object.keys(db.models).forEach((modelName) => {\r\n        if ('associate' in db.models[modelName]) {\r\n            db.models[modelName].associate(db.models);\r\n        }\r\n    });\r\n};\r\n\r\nexport default async (onConnect) => {\r\n    try {\r\n        await setAssociations(db);\r\n        await db.authenticate();\r\n        db.sync({ force: forceCleanDatabase });\r\n        onConnect();\r\n        console.log('Database connection OK!');\r\n    } catch (error) {\r\n        console.log('Unable to connect to the database:');\r\n    }\r\n}","import swaggerJSDoc from \"swagger-jsdoc\";\r\nimport swaggerUi from \"swagger-ui-express\";\r\nimport { swaggerConfig } from \"../config/swagger\";\r\n\r\nconst Documentation = (app) => {\r\n  // JSON of specs\r\n  const swaggerSpec = swaggerJSDoc(swaggerConfig);\r\n\r\n  // Api entrypoint\r\n  app.use(\"/docs\", swaggerUi.serve, swaggerUi.setup(swaggerSpec));\r\n};\r\n\r\nexport default Documentation;\r\n","/*Tenemos una función que recibe como parámetro la función de cada controlador,\r\nla ejecuta (resolve)\r\ny si  hay algún error, lo mostrará por consola y lanzará un 500\r\n*/\r\n\r\nexport const asyncHandler = controller => (req, res, next) => Promise\r\n  .resolve(controller(req, res, next))\r\n  .catch((err) => {\r\n    console.error('Request error:' + err.toString());\r\n    if (err) return res.sendStatus(500).send();\r\n});\r\n \r\nexport const socketHandler = controller => msg => Promise\r\n  .resolve(controller(msg))\r\n  .catch((err) => {\r\n    console.error('Socket error:' + err);\r\n});","import express from 'express';\r\nimport cors from 'cors';\r\nimport withSockets from './with-sockets';\r\n\r\nconst Middlewares = (app, io) => {\r\n    app.use(express.urlencoded({extended: true}));\r\n    app.use(express.json());\r\n    app.use(withSockets(io));\r\n    app.use(cors()) // Use this after the variable declaration\r\n};\r\n\r\nexport default Middlewares;","import { verifyToken } from '@Application/common/utils/access';\r\nexport const getHeader = (req, header) => req.headers[header];\r\n\r\nexport default (req, res, next) => {\r\n  const token = getHeader(req, 'authorization');\r\n\r\n  if (!token) {\r\n    return res.status(400).send('No token provided.');\r\n  }\r\n  return verifyToken(token, (err, { id } = {}) => {\r\n    if (err) {\r\n      return res.status(401).send('Failed to authenticate token.');\r\n    }\r\n\r\n    if (!id) {\r\n      return res.status(403).send('Wrong credentials');\r\n    }\r\n    req.userId = id;\r\n    return next();\r\n  });\r\n}","const withSockets = io => (req, res, next) => {\r\n    req.io = io;\r\n    return next();\r\n};\r\n\r\nexport default withSockets;\r\n","\r\nconst GenericModel = Model => ({\r\n    create(data) {\r\n        return Model.create(data);\r\n    },\r\n    get(conditions) {\r\n        return Model.findAll(conditions ? {where:conditions} : {});\r\n    },\r\n    getById(id) {\r\n        return Model.findOne({ where: { id } });\r\n    },\r\n    updateById(id, data) {\r\n        return Model.update(data, { where: { id } });\r\n    },\r\n    deleteById(id) {\r\n        return Model.destroy({ where: { id } });\r\n    },\r\n    findOrCreate(condition, newObj){\r\n        return Model.findOrCreate({where:condition, defaults: newObj});\r\n    }\r\n});\r\n\r\nexport default GenericModel;\r\n","import userRoutes from './user/adapters/http';\r\n// import userSockets from './user/adapters/socket';\r\n// import authRoutes from './auth/adapters/http';\r\n\r\nexport const Routes = (app) => {\r\n  userRoutes(app);\r\n  // authRoutes(app);\r\n}\r\n\r\nexport const Sockets = (io, socket) => {\r\n  // userSockets(io, socket);\r\n}","import express from 'express';\r\nimport Controller from '../../controller';\r\nimport { asyncHandler } from \"@Middlwares/error-handler\";\r\n// Para operaciones con acceso restringido, introduciremos un segundo parámetro que será la variable restrictedAccess\r\nimport restrictedAccess from \"@Middlwares/restricted-access\";\r\n\r\nconst router = express.Router();\r\n\r\nrouter.get('/', asyncHandler(async (req, res) => {\r\n    await Controller.create({ email: 'borrame@borrame.com' });\r\n    res.send('Llegamos a user');\r\n}));\r\n\r\nexport default app => app.use('/user', router);\r\n","import Model from \"../model\";\r\n\r\nconst Controller = {\r\n  get(conditions) {\r\n    return Model.get(conditions);\r\n  },\r\n  getById(id) {\r\n    return Model.getById(id);\r\n  },\r\n  create(data) {\r\n    return Model.create(data);\r\n  },\r\n  updateById(id, data) {\r\n    return Model.updateById(id, data);\r\n  },\r\n  deleteById(id) {\r\n    return Model.deleteById(id);\r\n  }\r\n}\r\n\r\nexport default Controller;","import Schema from './schema';\r\nimport GenericModel from '@Application/repository/generic-model';\r\n\r\nconst Model = {\r\n    ...GenericModel(Schema),\r\n    getByEmail: email => Schema.findOne({ where: { email } })\r\n};\r\n\r\nexport default Model;\r\n\r\n","import { db, DataTypes } from '@Application/database';\r\n\r\nexport default db.define('user', {\r\n\temail: DataTypes.STRING,\r\n\tauth0Id: DataTypes.STRING,\r\n});\r\n\r\n","module.exports = require(\"@babel/runtime/helpers/asyncToGenerator\");","module.exports = require(\"@babel/runtime/helpers/defineProperty\");","module.exports = require(\"@babel/runtime/regenerator\");","module.exports = require(\"cors\");","module.exports = require(\"express\");","module.exports = require(\"jsonwebtoken\");","module.exports = require(\"jwks-rsa\");","module.exports = require(\"sequelize\");","module.exports = require(\"socket.io\");","module.exports = require(\"swagger-jsdoc\");","module.exports = require(\"swagger-ui-express\");","module.exports = require(\"http\");","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import express from 'express';\r\nimport http from 'http';\r\nimport socketIO from 'socket.io';\r\nimport { config } from '@Application/config/sockets';\r\nimport Middlewares from './application/middlewares';\r\nimport { Routes, Sockets } from './entities';\r\nimport Documentation from './application/documentation';\r\nimport ConnectDatabase from './application/database';\r\n\r\nconst app = express();\r\n/*\r\nHeroku utiliza la variable de entorno process.env.port para asignar el puerto donde se va ejecutar el servidor,\r\npor eso la hemos definido en esta plantilla\r\n*/\r\nconst port = process.env.PORT;\r\nconst server = http.createServer(app);\r\nconst io = socketIO(server, config);\r\n\r\nDocumentation(app);\r\nMiddlewares(app, io);\r\nRoutes(app);\r\n\r\n\r\nConnectDatabase(() => {\r\n    server.listen(port, () => console.log(`Server listening to http://localhost:${port}`));\r\n});\r\n\r\nio.on('connection', (socket) => {\r\n    Sockets(io, socket);\r\n});"],"names":["jwt","getKey","verifyToken","token","Promise","resolve","reject","verify","err","decoded","id","sub","jwksClient","JWKS_URI","process","env","client","jwksUri","String","header","callback","getSigningKey","kid","key","signingKey","getPublicKey","config","cors","origin","methods","credentials","allowEIO3","swaggerConfig","definition","openapi","info","title","version","components","securitySchemes","ApiKeyAuth","type","name","security","securityDefinitions","basicAuth","apis","Sequelize","DataTypes","database","DB_NAME","user","DB_USER","password","DB_PASSWORD","host","DB_HOST","forceCleanDatabase","DB_FORCE_CLEAN","db","dialect","logging","setAssociations","Object","keys","models","forEach","modelName","associate","onConnect","authenticate","sync","force","console","log","swaggerJSDoc","swaggerUi","Documentation","app","swaggerSpec","use","serve","setup","asyncHandler","controller","req","res","next","error","toString","sendStatus","send","socketHandler","msg","express","withSockets","Middlewares","io","urlencoded","extended","json","getHeader","headers","status","userId","GenericModel","Model","create","data","get","conditions","findAll","where","getById","findOne","updateById","update","deleteById","destroy","findOrCreate","condition","newObj","defaults","userRoutes","Routes","Sockets","socket","Controller","restrictedAccess","router","Router","email","Schema","getByEmail","define","STRING","auth0Id","http","socketIO","ConnectDatabase","port","PORT","server","createServer","listen","on"],"sourceRoot":""}